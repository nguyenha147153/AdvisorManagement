@model IEnumerable<AdvisorManagement.Models.AccountUser>

@{
    ViewBag.Title = "Quản Lí Cố Vấn";
    Layout = "~/Views/Shared/_Layoutvlu.cshtml";
}


<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-0">Danh Sách Cố Vấn Học Tập</h5>
            </div>
            <div class="page-breadcrumb">
                <div class="row">

                    <div class="col-12 d-flex no-block align-items-center">
                        <div class="ms-auto text-end">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title"></h5>
                <div class="table-responsive">
                    <table id="zero_config" class="table table-hover table-danger table-striped table-bordered" role="grid" aria-describedby="zero_config_info">
                        <thead>
                            <tr>
                                <th>Stt</th>
                                <th>Mã số</th>
                                <th>Họ tên</th>
                                <th>Chức vụ</th>
                                <th>Số điện thoại</th>
                                <th>Ngày tham gia</th>
                                <th>Email</th>
                                <th>Hoạt động</th>
                            </tr>
                        </thead>
                        <tbody id="myTable">
                            @if (ViewBag.menu != null)
                            {
                                int i = 1;
                                foreach (var item in Model)
                                {
                                    <tr id="@item.id">
                                        <td>@i</td>
                                        <td>@item.user_code</td>
                                        <td>@item.user_name</td>
                                        <td>@item.Role.role_name</td>
                                        <td>@item.phone</td>
                                        <td>@item.create_time</td>
                                        <td>@item.email</td>
                                        <td style="width:250px">
                                            <a name="detail" class="btn btn-success"
                                               style="margin-bottom: 5px; margin-left: 5px; color: white">
                                                Chi tiết <i class="fas fa-tasks"></i>
                                            </a>
                                            <a name="update" id="update" class="btn btn-info" style="margin-bottom: 5px; margin-left: 5px;">
                                                Sửa <i class="fas fa-edit"></i>
                                            </a>
                                            <a name="delete" id="btnDelete" class="btn btn-danger"
                                               style="margin-bottom: 5px; margin-left: 5px;">
                                                Xoá <i class="fas fa-trash-alt"></i>
                                            </a>
                                        </td>
                                    </tr>
                                    i++;
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="modalCreate" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Thêm menu</h4>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Vai trò</span></div>
                    <div class="col-md-8">
                        @if (ViewBag.error != null)
                        {
                            var Error = (string)ViewBag.error;

                            @Html.Raw(Error)
                        }
                        <select id="id_role" name="id_role" style=" width: 155px;
                                                                height: 35px; text-align: center; font-size: 15px;">

                            @*@foreach (var item in rolelist)
                            {

                                <option value="@item.id">@item.role_name</option>


                            }*@


                        </select>

                    </div>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px; padding-top: 12px; padding-left: 15px">
                    <div class="col-md-4"><span>Tên menu có trong hệ thống</span></div>
                    <div class="col-md-8">
                        <select id="id_menu" name="id_menu" style=" width: 155px;
                                                                height: 35px; text-align: center; font-size: 15px;">

                            @*@foreach (var item in menulist)
                            {

                                <option value="@item.id">@item.menu_name</option>


                            }*@


                        </select>
                    </div>
                </div>
            </div>
            @* <div class="">
                    <div class="col-md-12" style="padding-bottom: 12px; padding-top: 12px; padding-left: 15px">
                        <div class="col-md-4"><span>HK1:</span></div>
                        <div class="col-md-8">
                            <input id="txtHk1" type="text" class="form-control" />
                        </div>
                    </div>
                </div>
                <div class="">
                    <div class="col-md-12" style="padding-bottom: 12px; padding-top: 12px; padding-left: 15px">
                        <div class="col-md-4"><span>HK2:</span></div>
                        <div class="col-md-8">
                            <input id="txtHk2" type="text" class="form-control" />
                        </div>
                    </div>
                </div>
                <div class="">
                    <div class="col-md-12" style="padding-bottom: 12px; padding-top: 12px; padding-left: 15px">
                        <div class="col-md-4"><span>HK3:</span></div>
                        <div class="col-md-8">
                            <input id="txtHk3" type="text" class="form-control" />
                        </div>
                    </div>
                </div>*@
            <div class="modal-footer">
                <button onclick="HideModal()" type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button id="btnUpload" class="btn btn-primary" type="submit">Thêm</button>
            </div>
        </div>
    </div>
</div>
<div id="modalUpdate" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Chỉnh sửa menu vào phân quyền</h4>
            </div>
            <input hidden id="id_rolemenu" value="" />
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Vai trò:</span></div>
                    <div class="col-md-8">
                        <select id="edit_id_role" name="edit_id_role" style=" width: 155px;
                                                                height: 35px; text-align: center; font-size: 15px;">

                            @*@foreach (var item in rolelist)
                            {


                                <option value="@item.id">@item.role_name</option>



                            }*@


                        </select>
                    </div>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px; padding-top: 12px; padding-left: 15px">
                    <div class="col-md-4"><span>Tên menu có trong hệ thống:</span></div>
                    <div class="col-md-8">
                        <select id="edit_id_menu" name="edit_id_menu" style=" width: 155px;
                                                                    height: 35px; text-align: center; font-size: 15px;">

                            @*@foreach (var item in menulist)
                            {

                                <option value="@item.id">@item.menu_name</option>


                            }*@


                        </select>

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="HideModalUp()" type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                <button id="btnEdit" class="btn btn-primary" type="submit">Sửa</button>
            </div>

        </div>
    </div>
</div>
<div id="modalDetail" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Chi tiết cố vấn học tập</h4>
            </div>
            <input hidden id="id_detailUser" value="" />
            <div class="mx-auto" style="width: 140px;">
                <div class="d-flex justify-content-center align-items-center rounded" style="height: 140px; background-color: rgb(233, 236, 239);">
                    <span style="color: rgb(166, 168, 170); font: bold 8pt Arial;">

                            <img src="" id="detail_img" alt="avatar"
                                 class="rounded-circle img-fluid" style="width: 150px;">
                        
                   
                    </span>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Mã cố vấn:</span></div>
                    <div class="col-md-8">
                        <input id="detail_code" type="text" class="form-control" disabled="disabled" />
                    </div>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Họ và tên:</span></div>
                    <div class="col-md-8">
                        <input id="detail_name" type="text" class="form-control" disabled="disabled" />
                    </div>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Địa chỉ:</span></div>
                    <div class="col-md-8">
                        <input id="detail_street" type="text" class="form-control" disabled="disabled" />
                    </div>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Email Văn Lang:</span></div>
                    <div class="col-md-8">
                        <input id="detail_mail" type="text" class="form-control" disabled="disabled" />
                    </div>
                </div>
            </div>
            <div class="">
                <div class="col-md-12" style="padding-bottom: 12px;padding-top: 12px; padding-left:15px">
                    <div class="col-md-4"><span>Số điện thoại:</span></div>
                    <div class="col-md-8">
                        <input id="detail_phone" type="text" class="form-control" disabled="disabled" />
                    </div>
                </div>
            </div>


            @*<div class="modal-footer">
            <button onclick="HideModalDtail()" type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
        </div>*@

        </div>
    </div>
</div>
<script src="~/Assets/extra-libs/DataTables/datatables.min.js"></script>
<script>
    $(document).ready(function () {
        $("#myInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });
</script>
<script>


    function myFunction() {
        var input, filter, table, tr, td, i;
        input = document.getElementById("semester");
        filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[3];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }

    $(document).ready(function () {
        $("#myInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });
    $("#zero_config").DataTable();
    // get thong tin nguoi dung
     $(document).on('click', "a[name=detail]", function () {
         let id_iddetail = $(this).closest('tr').attr('id');
         //console.log(id_iddetail);
         $.ajax({
             url:'@Url.Action("Details", "AccountUsers")' ,
             type: 'get',
             data: {
                 id: id_iddetail
             },
             success: function (data) {
                console.log(data);

                 if (data.success == true) {
                     $('#detail_code').val(data.detail_code);
                     $('#detail_name').val(data.detail_name);
                     $('#detail_street').val(data.detail_street);
                     $('#detail_mail').val(data.detail_mail);
                     $('#detail_phone').val(data.detail_phone);
                     $('#detail_img').attr('src',data.detail_img);

                     $('#id_detailUser').val(data.id_detailUser);
                     $('#modalDetail').modal("show");
                 } else {
                     Swal.fire(
                         'Thông báo',
                         data.message
                     );
                 }
             }

         })
     })

</script>
